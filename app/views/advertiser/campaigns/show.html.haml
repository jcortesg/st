- if flash.any?
  .row
    .span12
      = render '/shared/flash', flash: flash

.row
  .span12
    %ul.breadcrumb
      %li
        = link_to(t('campaigns'), [:advertiser, :campaigns])
        %span.divider /
      %li.active= @campaign.name

.row
  .span12
    .round_box
      .content
        .right
          - if @campaign.status != 'created'
            = link_to(t('statistics'), [:statistics, :advertiser, @campaign], :class => 'btn btn-primary')
          - if current_user.advertiser.can_create_campaigns? && @campaign.status != 'archived'
            = link_to(t('new_tweet'), [:advertiser, @campaign, :tweets], :class => 'btn btn-primary')
        %h1.title= "Campaña #{@campaign.name}"

        %table.table.table-striped
          %thead
            %tr
              %th= sort_link(@search, :influencer_first_name_and_influencer_last_name, 'Celebridad')
              %th= t('clicks')
              %th= t('cost')
              %th= sort_link(@search, :status, t('status'))
              %th= sort_link(@search, :tweet_at, t('a_date'))
              %th= t('actions')

          %tbody
            - @tweets.each do |tweet|
              %tr{ :class => cycle('odd', 'even') }
                %td= tweet.influencer.full_name
                %td= link_to(tweet.clicks_count, [:advertiser, tweet.campaign, tweet, :clicks])
                %td= tweet.fee_type == 'tweet_fee' ? "Tweet: $#{sprintf("%.02f", tweet.tweet_fee)}" : "Click: $#{sprintf("%.02f", tweet.cpc_fee)}"
                %td= advertiser_tweet_status(tweet.status)
                %td= tweet.tweet_at.strftime("%d/%m/%y %H:%M")
                %td= link_to("Detalle", [:advertiser, @campaign, tweet], class: 'btn')

        .filters
          .subtitle= t('search')
          = simple_form_for @search, :url => [:advertiser, @campaign], html: {method: :get, id: 'filter_form', class: 'form-horizontal'} do |f|
            = f.input :influencer_first_name_or_influencer_last_name_contains, label: "Celebridad", required: false
            = f.input :status_equals, label: 'Estado', required: false, as: 'select', collection: [['Propuesto', 'created'], ['Revisado por celebridad', 'influencer_reviewed'], ['Rechazado por celebridad', 'influencer_rejected'], ['En revisión por celebridad', 'advertiser_reviewed'], ['Rechazado por anunciante', 'advertiser_rejected'], ['Aceptado', 'accepted'], ['Públicado', 'activated'], ['Vencido', 'expired']]
            .form-actions
              = f.submit 'Búscar', :class => 'btn btn-primary'
              = link_to t('cancel'), '#', :class => 'btn reset'


    - if @campaign.hashtags.count > 0
      .round_box{style: 'min-height: 10px'}
        .content
          %h1.title= t('hashtags')

          - @campaign.hashtags.all.each do |hashtag|
            = link_to(hashtag.hashtag, "https://twitter.com/#!/search/#{hashtag.hashtag}", target: '_blank')
            = "&nbsp;&nbsp;".html_safe

- html = "<!-- begin olark code --><script data-cfasync=\"false\" type='text/javascript'>/*{literal}<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol==\"https:\"?\"https:\":\"http:\",z=c.name,r=\"load\";var nt=function(){f[z]=function(){(a.s=a.s||[]).push(arguments)};var a=f[z]._={},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){f[z](\"call\",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={0:+new Date};a.P=function(u){a.p[u]=new Date-a.p[0]};function s(){a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent(\"on\"+r,s);var ld=function(){function p(hd){hd=\"head\";return[\"<\",hd,\"></\",hd,\"><\",i,' onl' + 'oad=\"var d=',g,\";d.getElementsByTagName('head')[0].\",j,\"(d.\",h,\"('script')).\",k,\"='\",l,\"//\",a.l,\"'\",'\"',\"></\",i,\">\"].join(\"\")}var i=\"body\",m=d[i];if(!m){return setTimeout(ld,100)}a.P(1);var j=\"appendChild\",h=\"createElement\",k=\"src\",n=d[h](\"div\"),v=n[j](d[h](z)),b=d[h](\"iframe\"),g=\"document\",e=\"domain\",o;n.style.display=\"none\";m.insertBefore(n,m.firstChild).id=z;b.frameBorder=\"0\";b.id=z+\"-loader\";if(/MSIE[ ]+6/.test(navigator.userAgent)){b.src=\"javascript:false\"}b.allowTransparency=\"true\";v[j](b);try{b.contentWindow[g].open()}catch(w){c[e]=d[e];o=\"javascript:var d=\"+g+\".open();d.domain='\"+d.domain+\"';\";b[k]=o+\"void(0);\"}try{var t=b.contentWindow[g];t.write(p());t.close()}catch(x){b[k]=o+'d.write(\"'+p().replace(/\"/g,String.fromCharCode(92)+'\"')+'\");d.close();'}a.P(2)};ld()};nt()})({loader: \"static.olark.com/jsclient/loader0.js\",name:\"olark\",methods:[\"configure\",\"extend\",\"declare\",\"identify\"]});/* custom configuration goes here (www.olark.com/documentation) */olark.identify('9176-655-10-5717');/*]]>{/literal}*/</script><noscript><a href=\"https://www.olark.com/site/9176-655-10-5717/contact\" title=\"Contact us\" target=\"_blank\">Questions? Feedback?</a> powered by <a href=\"http://www.olark.com?welcome\" title=\"Olark live chat software\">Olark live chat software</a></noscript><!-- end olark code -->"
= raw html